package com.xcontent.performance.repository;

import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;
import org.springframework.stereotype.Repository;
import java.util.*;

@Repository
public interface PerformanceMetricsRepository extends MongoRepository<PerformanceMetrics, String> {
    
    @Query(value = "{ 'type': ?0, 'timestamp': { $gte: ?1, $lte: ?2 } }")
    List<PerformanceMetrics> findByTypeAndTimeRange(
        MetricType type,
        Long startTime,
        Long endTime
    );

    @Query(value = "{ 'type': ?0 }", sort = "{ 'timestamp': -1 }")
    List<PerformanceMetrics> findLatestByType(
        MetricType type,
        Pageable pageable
    );
}

@Repository
public interface BatchJobRepository extends MongoRepository<BatchJob, String> {
    
    @Query("{ 'status': ?0, 'type': ?1 }")
    List<BatchJob> findByStatusAndType(
        BatchStatus status,
        BatchType type
    );

    @Query("{ 'status': ?0, 'priority': { $gte: ?1 } }")
    List<BatchJob> findHighPriorityJobs(
        BatchStatus status,
        Integer minPriority
    );
}
