package com.xcontent.model;

import lombok.Data;
import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;
import java.util.*;

@Data
@Document(collection = "template_permissions")
public class TemplatePermission {
    @Id
    private String id;
    private String templateId;
    private String userId;
    private String groupId;
    private Set<TemplatePrivilege> privileges;
    private boolean inherited;
    private String inheritedFrom;
    private Long grantedAt;
    private String grantedBy;
    private Long expiresAt;
    private Map<String, Object> conditions;
}

public enum TemplatePrivilege {
    VIEW,
    EDIT,
    DELETE,
    SHARE,
    EXPORT,
    MANAGE_VERSIONS,
    MANAGE_PERMISSIONS,
    PREVIEW,
    APPROVE
}

@Data
@Document(collection = "template_sharing")
public class TemplateSharing {
    @Id
    private String id;
    private String templateId;
    private SharingType type;
    private String sharedWith;
    private Set<TemplatePrivilege> privileges;
    private Long sharedAt;
    private String sharedBy;
    private Long expiresAt;
    private String accessKey;
    private Map<String, Object> restrictions;
}

public enum SharingType {
    USER,
    GROUP,
    ORGANIZATION,
    PUBLIC,
    TEMPORARY
}

@Data
@Document(collection = "approval_workflows")
public class ApprovalWorkflow {
    @Id
    private String id;
    private String templateId;
    private String name;
    private List<ApprovalStep> steps;
    private ApprovalStatus status;
    private Long createdAt;
    private String createdBy;
    private Long updatedAt;
    private Map<String, Object> settings;
}

@Data
public class ApprovalStep {
    private String id;
    private String name;
    private List<String> approvers;
    private ApprovalType type;
    private int requiredApprovals;
    private Long timeoutHours;
    private Map<String, Object> conditions;
    private List<ApprovalAction> actions;
}

public enum ApprovalType {
    SEQUENTIAL,
    PARALLEL,
    ANY_ONE
}

public enum ApprovalStatus {
    DRAFT,
    IN_PROGRESS,
    APPROVED,
    REJECTED,
    CANCELLED
}

@Data
public class ApprovalAction {
    private String type;
    private Map<String, Object> parameters;
    private String description;
}
